generator client {
  provider = "prisma-client-js"
  engineType = "binary"
  binaryTargets = ["native"]
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_PRISMA_URL")
}

model User {
  id        String    @id @default(uuid()) @db.Uuid
  name      String?
  email     String    @unique
  password  String?
  ava       String?
  provider  String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  products  Product[]
  orders    Order[]
  prices    Price[]
  profilePictures ProfilePicture[]
  productPictures ProductPicture[]
  productTypes ProductType[]
  currencies Currency[]
  orderLocations OrderLocation[]
  pickupLocations PickupLocation[]
}

model Product {
  id             String    @id @default(uuid()) @db.Uuid
  serialNumber   String
  isNew          Boolean   @default(false)
  photo          String?
  title          String
  type           String?
  specification  String?
  guaranteeStart DateTime?
  guaranteeEnd   DateTime?
  date           DateTime?
  orderId        String?   @db.Uuid
  userId         String    @db.Uuid
  prices         Price[]
  order          Order?   @relation(fields: [orderId], references: [id], onDelete: SetNull)
  user           User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([serialNumber])
  @@index([userId])
}

model Order {
  id               String    @id @default(uuid()) @db.Uuid
  title            String
  date             DateTime
  description      String?
  amountOfProducts Int?
  userId           String    @db.Uuid
  products         Product[]
  user             User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  location         OrderLocation?

  @@index([userId])
}

model Price {
  id        String   @id @default(uuid()) @db.Uuid
  value     Int
  symbol    String
  isDefault Boolean  @default(false)
  productId String   @db.Uuid
  userId    String   @db.Uuid
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([productId])
  @@index([userId])
}

model ProductType {
  id        String   @id @default(uuid()) @db.Uuid
  userId    String   @db.Uuid
  value     String
  title     String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  @@map("ProductType")
}

model Currency {
  id        String   @id @default(uuid()) @db.Uuid
  userId    String   @db.Uuid
  value     String
  title     String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  @@map("Currency")
}

model ProfilePicture {
  id        String   @id @default(uuid()) @db.Uuid
  userId    String   @db.Uuid
  url String
  pictureId      String
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  @@map("ProfilePicture")
}

model ProductPicture {
  id             String    @id @default(uuid()) @db.Uuid
  productId     String    @db.Uuid
  userId         String    @db.Uuid
  url     String
  pictureId      String
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("ProductPicture")
}

model OrderLocation {
  id        String  @id @default(uuid())
  latitude  Float
  longitude Float
  country   String?
  state     String?
  city      String?
  district  String?
  street    String?
  postcode  String?
  displayName String?
  orderId   String   @db.Uuid @unique
  userId    String   @db.Uuid
  order     Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("OrderLocation")
}

model PickupLocation {
  id        String  @id @default(uuid())
  latitude  Float
  longitude Float
  country   String?
  state     String?
  city      String?
  district  String?
  street    String?
  postcode  String?
  displayName String?
  userId    String   @db.Uuid
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("PickupLocation")
}
