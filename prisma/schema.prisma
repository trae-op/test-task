generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_PRISMA_URL")
}

model User {
  id        String    @id @default(uuid()) @db.Uuid
  name      String?
  email     String    @unique
  password  String?
  ava       String?
  provider  String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  products  Product[]
  orders    Order[]
  prices    Price[]
  profilePictures ProfilePicture[]
  orderPictures OrderPicture[]
  productPictures ProductPicture[]
}

model Product {
  id             String    @id @default(uuid()) @db.Uuid
  serialNumber   String
  isNew          Boolean   @default(false)
  photo          String?
  title          String
  type           String?
  specification  String?
  guaranteeStart DateTime?
  guaranteeEnd   DateTime?
  date           DateTime?
  orderId        String?   @db.Uuid
  userId         String    @db.Uuid
  prices         Price[]
  order          Order?   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  user           User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([serialNumber])
  @@index([userId])
}

model Order {
  id               String    @id @default(uuid()) @db.Uuid
  title            String
  date             DateTime
  description      String?
  amountOfProducts Int?
  userId           String    @db.Uuid
  products         Product[]
  user             User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model Price {
  id        String   @id @default(uuid()) @db.Uuid
  value     Int
  symbol    String
  isDefault Boolean  @default(false)
  productId String   @db.Uuid
  userId    String   @db.Uuid
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([productId])
  @@index([userId])
}


model ProfilePicture {
  id        String   @id @default(uuid()) @db.Uuid
  userId    String   @db.Uuid
  url String
  pictureId      String
  createdAt DateTime @default(now())
  
    user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("ProfilePicture")
}

model OrderPicture {
  id             String    @id @default(uuid()) @db.Uuid
  orderId       String    @db.Uuid
  userId         String    @db.Uuid
  url     String
  pictureId      String
  createdAt DateTime @default(now())
  
    user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("OrderPicture")
}


model ProductPicture {
  id             String    @id @default(uuid()) @db.Uuid
  productId     String    @db.Uuid
  userId         String    @db.Uuid
  url     String
  pictureId      String
  createdAt DateTime @default(now())
  
    user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("ProductPicture")
}